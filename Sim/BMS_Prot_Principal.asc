Version 4
SHEET 1 3908 3692
WIRE -912 -128 -992 -128
WIRE -720 -128 -784 -128
WIRE -416 -128 -480 -128
WIRE -784 -48 -784 -128
WIRE -480 -48 -480 -128
WIRE -48 -48 -48 -64
WIRE -48 -48 -80 -48
WIRE 80 -48 16 -48
WIRE 320 -48 272 -48
WIRE 448 -48 384 -48
WIRE -992 -32 -992 -128
WIRE -80 48 -80 -48
WIRE 32 48 -80 48
WIRE 1696 48 1504 48
WIRE 1968 48 1760 48
WIRE 2144 48 2032 48
WIRE 272 64 272 -48
WIRE 272 64 224 64
WIRE 336 64 272 64
WIRE -992 96 -992 48
WIRE -784 96 -784 32
WIRE -720 96 -784 96
WIRE -480 96 -480 32
WIRE -448 96 -480 96
WIRE -80 96 -80 48
WIRE 224 112 224 64
WIRE -80 208 -80 176
WIRE 1792 208 1712 208
WIRE 224 224 224 192
WIRE 1712 272 1712 208
WIRE -816 288 -896 288
WIRE -576 288 -656 288
WIRE -896 352 -896 288
WIRE -656 352 -656 288
WIRE 1712 352 1552 352
WIRE 1712 416 1712 352
WIRE 1552 432 1552 352
WIRE 1712 448 1712 416
WIRE 1712 448 1648 448
WIRE 3456 448 3376 448
WIRE 3552 448 3456 448
WIRE 3728 448 3552 448
WIRE -896 480 -896 432
WIRE -656 480 -656 432
WIRE 1712 496 1712 448
WIRE 1360 544 1312 544
WIRE 1504 544 1504 48
WIRE 1504 544 1440 544
WIRE 1552 544 1552 512
WIRE 1552 544 1504 544
WIRE 1648 544 1648 512
WIRE 1648 544 1552 544
WIRE 1696 544 1648 544
WIRE 1952 544 1792 544
WIRE 2080 544 2048 544
WIRE 2144 544 2144 48
WIRE 2144 544 2080 544
WIRE 2176 544 2144 544
WIRE 2336 544 2176 544
WIRE 2464 544 2336 544
WIRE 2656 544 2464 544
WIRE 2800 544 2656 544
WIRE 3376 544 3376 448
WIRE 3456 560 3456 512
WIRE 3456 560 3424 560
WIRE 3552 560 3552 528
WIRE 3552 560 3456 560
WIRE 2656 576 2656 544
WIRE 2336 592 2336 544
WIRE 2464 592 2464 544
WIRE 3456 608 3456 560
WIRE 1312 640 1312 544
WIRE 2080 640 2080 544
WIRE 2176 640 2176 544
WIRE 2032 672 2032 592
WIRE 2656 672 2656 640
WIRE 3376 672 3376 640
WIRE 3376 672 3200 672
WIRE 2336 704 2336 672
WIRE 2384 704 2336 704
WIRE 3456 720 3456 688
WIRE 2336 736 2336 704
WIRE 2464 736 2464 672
WIRE 2560 736 2464 736
WIRE 2032 752 2032 672
WIRE 2080 752 2080 704
WIRE 2080 752 2032 752
WIRE 2176 752 2176 720
WIRE 2176 752 2080 752
WIRE 2032 768 2032 752
WIRE 2384 768 2384 704
WIRE 2560 768 2560 736
WIRE 2464 784 2464 736
WIRE 400 800 304 800
WIRE 736 800 480 800
WIRE 2176 800 2176 752
WIRE 2656 800 2656 736
WIRE 2832 800 2656 800
WIRE 3456 832 3456 784
WIRE 3696 832 3456 832
WIRE -272 848 -368 848
WIRE -80 848 -192 848
WIRE 416 848 352 848
WIRE -832 864 -960 864
WIRE -672 864 -752 864
WIRE 1312 864 1312 720
WIRE 1344 864 1312 864
WIRE 1392 864 1344 864
WIRE 1504 864 1472 864
WIRE 1536 864 1504 864
WIRE 2384 864 2384 832
WIRE 2560 864 2560 832
WIRE 736 880 736 800
WIRE 736 880 704 880
WIRE -256 896 -320 896
WIRE 352 896 352 848
WIRE 464 896 464 848
WIRE 496 896 464 896
WIRE -816 912 -864 912
WIRE 736 912 704 912
WIRE -320 944 -320 896
WIRE -208 944 -208 896
WIRE -176 944 -208 944
WIRE 2176 944 2176 880
WIRE -864 960 -864 912
WIRE -768 960 -768 912
WIRE -752 960 -768 960
WIRE 736 992 736 912
WIRE 736 992 256 992
WIRE 1312 1008 1312 864
WIRE 2176 1008 2176 992
WIRE 2032 1024 2032 848
WIRE 2176 1024 2176 1008
WIRE 2176 1024 2032 1024
WIRE 2176 1040 2176 1024
WIRE 400 1088 304 1088
WIRE 720 1088 480 1088
WIRE 2176 1104 2176 1088
WIRE -832 1120 -960 1120
WIRE -672 1120 -752 1120
WIRE -288 1120 -384 1120
WIRE -96 1120 -208 1120
WIRE 416 1136 352 1136
WIRE 720 1136 720 1088
WIRE 736 1136 720 1136
WIRE -816 1168 -864 1168
WIRE -272 1168 -336 1168
WIRE 736 1168 720 1168
WIRE 352 1184 352 1136
WIRE 464 1184 464 1136
WIRE 496 1184 464 1184
WIRE -864 1216 -864 1168
WIRE -768 1216 -768 1168
WIRE -752 1216 -768 1216
WIRE -336 1216 -336 1168
WIRE -224 1216 -224 1168
WIRE -192 1216 -224 1216
WIRE 720 1280 720 1168
WIRE 720 1280 256 1280
WIRE -16 1584 -80 1584
WIRE 64 1584 -16 1584
WIRE 400 1584 144 1584
WIRE 704 1584 400 1584
WIRE 944 1584 800 1584
WIRE 960 1584 944 1584
WIRE 1296 1584 1232 1584
WIRE 1376 1584 1296 1584
WIRE 1728 1584 1456 1584
WIRE 2016 1584 1728 1584
WIRE 2256 1584 2112 1584
WIRE 2272 1584 2256 1584
WIRE -80 1616 -80 1584
WIRE 400 1616 400 1584
WIRE 1232 1616 1232 1584
WIRE 1728 1616 1728 1584
WIRE 80 1632 32 1632
WIRE 704 1632 528 1632
WIRE 1392 1632 1344 1632
WIRE 2016 1632 1840 1632
WIRE -816 1664 -1008 1664
WIRE -640 1664 -736 1664
WIRE -512 1664 -640 1664
WIRE -416 1664 -448 1664
WIRE 32 1664 32 1632
WIRE 1344 1664 1344 1632
WIRE -1008 1680 -1008 1664
WIRE -416 1680 -416 1664
WIRE 128 1680 128 1632
WIRE 176 1680 128 1680
WIRE 1440 1680 1440 1632
WIRE 1488 1680 1440 1680
WIRE -640 1696 -640 1664
WIRE -800 1712 -832 1712
WIRE 400 1712 400 1696
WIRE 1728 1712 1728 1696
WIRE -80 1728 -80 1696
WIRE 1232 1728 1232 1696
WIRE -832 1760 -832 1712
WIRE -752 1776 -752 1712
WIRE -416 1776 -416 1760
WIRE -1328 1792 -1504 1792
WIRE -1008 1792 -1008 1760
WIRE -640 1792 -640 1776
WIRE -1504 1824 -1504 1792
WIRE -1504 1952 -1504 1904
WIRE -832 2016 -1024 2016
WIRE -656 2016 -752 2016
WIRE -528 2016 -656 2016
WIRE -432 2016 -464 2016
WIRE -1024 2032 -1024 2016
WIRE -432 2032 -432 2016
WIRE -16 2032 -80 2032
WIRE 64 2032 -16 2032
WIRE 144 2032 96 2032
WIRE 400 2032 144 2032
WIRE 528 2032 528 1632
WIRE 528 2032 400 2032
WIRE 1296 2032 1232 2032
WIRE 1376 2032 1296 2032
WIRE 1456 2032 1408 2032
WIRE 1696 2032 1456 2032
WIRE 1840 2032 1840 1632
WIRE 1840 2032 1696 2032
WIRE -656 2048 -656 2016
WIRE -80 2064 -80 2032
WIRE 400 2064 400 2032
WIRE 1232 2064 1232 2032
WIRE 1696 2064 1696 2032
WIRE -768 2080 -768 2064
WIRE -752 2080 -768 2080
WIRE 80 2080 32 2080
WIRE 1392 2080 1344 2080
WIRE -752 2096 -752 2080
WIRE -832 2112 -848 2112
WIRE -816 2112 -816 2064
WIRE -816 2112 -832 2112
WIRE 32 2112 32 2080
WIRE 1344 2112 1344 2080
WIRE -432 2128 -432 2112
WIRE 128 2128 128 2080
WIRE 176 2128 128 2128
WIRE 1440 2128 1440 2080
WIRE 1488 2128 1440 2128
WIRE -1024 2144 -1024 2112
WIRE -656 2144 -656 2128
WIRE 400 2160 400 2144
WIRE 1696 2160 1696 2144
WIRE -80 2176 -80 2144
WIRE 1232 2176 1232 2144
FLAG -992 96 0
FLAG -912 -128 V_DRV
FLAG -896 480 0
FLAG -656 480 0
FLAG -720 -128 CHG_DRV
FLAG -416 -128 DSG_DRV
FLAG 1312 544 BAT+
FLAG 2800 544 PACK+
FLAG 1792 208 CHG
FLAG 2032 1024 DSG
FLAG 2336 736 PACK
FLAG 2464 784 LD
FLAG 2832 800 PACK-
FLAG -720 96 BAT+
FLAG -448 96 BAT+
FLAG -864 960 0
FLAG -752 960 INV_EN_CHG
FLAG -320 944 0
FLAG -176 944 INV_EN_DSG
FLAG -960 864 CHG
FLAG -672 864 BAT+
FLAG -864 1216 0
FLAG -752 1216 EN_CHG
FLAG -960 1120 CHG_DRV
FLAG -672 1120 CHG
FLAG -368 848 DSG
FLAG -80 848 LD
FLAG -336 1216 0
FLAG -192 1216 EN_DSG
FLAG -384 1120 DSG_DRV
FLAG -96 1120 DSG
FLAG 352 896 0
FLAG 496 896 EN_CHG
FLAG 304 800 PACK+
FLAG 256 992 PACK-
FLAG 352 1184 0
FLAG 496 1184 EN_DSG
FLAG 304 1088 PACK+
FLAG 256 1280 PACK-
FLAG 1312 1008 0
FLAG -80 208 0
FLAG 32 48 EN_CHG
FLAG 224 224 0
FLAG 336 64 EN_DSG
FLAG 448 -48 INV_EN_DSG
FLAG 80 -48 INV_EN_CHG
FLAG 2032 672 D_GATE
FLAG 1712 416 C_GATE
FLAG 3200 672 D_GATE
FLAG 2384 864 0
FLAG 2560 864 0
FLAG 2176 1104 0
FLAG 3728 448 PACK+
FLAG 3696 832 PACK-
FLAG -1008 1792 0
FLAG -832 1760 0
FLAG -640 1792 0
FLAG -640 1664 TRIP_OCD
FLAG -416 1776 0
FLAG -416 1664 nTRIP_OCD
FLAG -80 1728 0
FLAG -16 1584 DELAY_OCD
FLAG 32 1664 0
FLAG 176 1680 DELAY_OCD
FLAG 400 1712 0
FLAG -80 2176 0
FLAG -16 2032 nDELAY_OCD
FLAG 32 2112 0
FLAG 176 2128 nDELAY_OCD
FLAG 400 2160 0
FLAG 944 1584 FAULT_OCD
FLAG 1536 864 PACK-
FLAG 1504 864 SRP
FLAG 1344 864 SRN
FLAG -1504 1952 0
FLAG -1328 1792 V_CURR
FLAG -752 1776 V_CURR
FLAG -1024 2144 0
FLAG -656 2144 0
FLAG -656 2016 TRIP_OCC
FLAG -432 2128 0
FLAG -432 2016 nTRIP_OCC
FLAG 1232 1728 0
FLAG 1296 1584 DELAY_OCC
FLAG 1344 1664 0
FLAG 1488 1680 DELAY_OCC
FLAG 1728 1712 0
FLAG 1232 2176 0
FLAG 1296 2032 nDELAY_OCC
FLAG 1344 2112 0
FLAG 1488 2128 nDELAY_OCC
FLAG 1696 2160 0
FLAG 2256 1584 FAULT_OCC
FLAG -832 2112 V_CURR
FLAG -752 2096 0
FLAG -816 288 CMD_CHG
FLAG -576 288 CMD_DSG
SYMBOL voltage 1312 624 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 48
SYMBOL voltage -992 -48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 11
SYMBOL voltage -896 336 R0
WINDOW 3 -104 209 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 1 1.2 1 1.2001 0 2 0)
SYMATTR InstName V3
SYMBOL voltage -656 336 R0
WINDOW 3 -138 253 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 0 1.2 0 1.2001 1 2 1)
SYMATTR InstName V4
SYMBOL nmos 1952 592 R270
WINDOW 0 119 -8 VRight 2
WINDOW 3 141 -20 VRight 2
SYMATTR InstName M1
SYMATTR Value BSC160N10NS3
SYMBOL nmos 1792 496 R90
WINDOW 0 72 36 VRight 2
WINDOW 3 99 -56 VRight 2
SYMATTR InstName M2
SYMATTR Value BSC160N10NS3
SYMBOL cap 1760 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 0.1µ
SYMBOL cap 2032 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 0.1µ
SYMBOL res 1696 256 R0
SYMATTR InstName R1
SYMATTR Value 5.1k
SYMBOL zener 1664 512 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value MMBZ16VALY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 1536 416 R0
WINDOW 0 1 150 Left 2
WINDOW 3 -24 177 Left 2
SYMATTR InstName R2
SYMATTR Value 10Meg
SYMBOL zener 2064 640 R0
SYMATTR InstName D2
SYMATTR Value MMBZ16VALY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2192 736 R180
WINDOW 0 -40 98 Left 2
WINDOW 3 -74 65 Left 2
SYMATTR InstName R3
SYMATTR Value 10Meg
SYMBOL res 2016 752 R0
SYMATTR InstName R4
SYMATTR Value 5.1k
SYMBOL res 2320 576 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 2448 576 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL cap 2640 576 R0
SYMATTR InstName C3
SYMATTR Value 0.1µ
SYMBOL cap 2640 672 R0
SYMATTR InstName C4
SYMATTR Value 0.1µ
SYMBOL sw -848 864 R270
WINDOW 3 76 -21 VRight 2
SYMATTR Value SW_CHG_EN
SYMATTR InstName S1
SYMBOL sw -288 848 R270
WINDOW 3 81 -20 VRight 2
SYMATTR Value SW_DSG_EN
SYMATTR InstName S2
SYMBOL sw -848 1120 R270
WINDOW 3 73 -25 VRight 2
SYMATTR Value SW_CHG_INV_EN
SYMATTR InstName S3
SYMBOL sw -304 1120 R270
WINDOW 3 78 -43 VRight 2
SYMATTR Value SW_DSG_INV_EN
SYMATTR InstName S4
SYMBOL sw 384 800 R270
WINDOW 3 81 -20 VRight 2
SYMATTR Value SW_CHARGE
SYMATTR InstName S5
SYMBOL sw 384 1088 R270
WINDOW 3 81 -20 VRight 2
SYMATTR Value SW_LOAD
SYMATTR InstName S6
SYMBOL bv -784 -64 R0
SYMATTR InstName B2
SYMATTR Value V=V(V_DRV)
SYMBOL bv -480 -64 R0
SYMATTR InstName B4
SYMATTR Value V=V(V_DRV)
SYMBOL bv -80 80 R0
WINDOW 3 -46 186 Left 2
SYMATTR Value V={ if( (V(CMD_CHG) > 0.5) & V(FAULT_OCC) < 1, 1, 0) }
SYMATTR InstName B6
SYMBOL bv 224 96 R0
WINDOW 3 -171 211 Left 2
SYMATTR Value V={if((V(CMD_DSG) > 0.5) & V(FAULT_OCD) < 1 , 1, 0) }
SYMATTR InstName B7
SYMBOL Digital\\inv 320 -112 R0
SYMATTR InstName A1
SYMBOL Digital\\inv -48 -112 R0
SYMATTR InstName A2
SYMBOL zener 3440 448 R0
WINDOW 3 -53 -46 Left 2
SYMATTR Value MMBZ16VALY
SYMATTR InstName D3
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 3568 544 R180
WINDOW 0 -40 98 Left 2
WINDOW 3 -74 65 Left 2
SYMATTR InstName R9
SYMATTR Value 10Meg
SYMBOL res 3440 592 R0
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL diode 3472 784 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMATTR Value MMSD4148
SYMBOL res 2160 784 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL nmos 3424 640 R180
WINDOW 0 103 29 Right 2
WINDOW 3 222 55 Right 2
SYMATTR InstName M3
SYMATTR Value BSC160N10NS3
SYMBOL zener 2192 1088 R180
WINDOW 3 24 0 Left 2
WINDOW 0 24 64 Left 2
SYMATTR Value UDZLV100
SYMATTR InstName D5
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL zener 2160 944 R0
SYMATTR Value UDZLV100
SYMATTR InstName D6
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL zener 2400 832 R180
WINDOW 3 24 0 Left 2
WINDOW 0 24 64 Left 2
SYMATTR Value UDZLV100
SYMATTR InstName D7
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL zener 2576 832 R180
WINDOW 3 24 0 Left 2
WINDOW 0 24 64 Left 2
SYMATTR Value UDZLV100
SYMATTR InstName D8
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL sw -832 1664 R270
WINDOW 0 80 44 VRight 2
WINDOW 3 57 40 VRight 2
SYMATTR InstName S7
SYMATTR Value SWOCD
SYMBOL voltage -1008 1664 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 1
SYMBOL res -656 1680 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL Digital\\inv -512 1600 R0
SYMATTR InstName A3
SYMBOL res -432 1664 R0
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL bv -80 1600 R0
WINDOW 3 -85 185 Left 2
SYMATTR Value V= idt(V(trip_ocd)/TTRIP, 0, V(trip_ocd) < 0.5)
SYMATTR InstName B1
SYMBOL sw 48 1584 R270
WINDOW 0 64 86 VRight 2
WINDOW 3 40 78 VRight 2
SYMATTR InstName S8
SYMATTR Value SWLATCH
SYMBOL res 384 1600 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL Digital\\srflop 752 1536 R0
SYMATTR InstName A4
SYMBOL bv -80 2048 R0
WINDOW 3 -43 187 Left 2
SYMATTR Value V= idt(V(ntrip_ocd)/TTRIP, 0, V(ntrip_ocd) < 0.5)
SYMATTR InstName B3
SYMBOL sw 48 2032 R270
WINDOW 3 46 22 VRight 2
WINDOW 0 68 26 VRight 2
SYMATTR Value SWLATCH
SYMATTR InstName S9
SYMBOL res 384 2048 R0
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res 1488 848 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_SHUNT
SYMATTR Value 1m
SYMBOL bv -1504 1808 R0
WINDOW 3 -85 185 Left 2
SYMATTR Value V= (V(SRP) - V(SRN))
SYMATTR InstName B5
SYMBOL sw -848 2016 R270
WINDOW 0 80 53 VRight 2
WINDOW 3 57 49 VRight 2
SYMATTR InstName S10
SYMATTR Value SWOCC
SYMBOL voltage -1024 2016 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 1
SYMBOL res -672 2032 R0
SYMATTR InstName R15
SYMATTR Value 100k
SYMBOL Digital\\inv -528 1952 R0
SYMATTR InstName A5
SYMBOL res -448 2016 R0
SYMATTR InstName R16
SYMATTR Value 100k
SYMBOL bv 1232 1600 R0
WINDOW 3 -85 185 Left 2
SYMATTR Value V= idt(V(trip_occ)/TTRIP, 0, V(trip_occ) < 0.5)
SYMATTR InstName B8
SYMBOL sw 1360 1584 R270
WINDOW 0 77 43 VRight 2
WINDOW 3 57 43 VRight 2
SYMATTR InstName S11
SYMATTR Value SWLATCH
SYMBOL res 1712 1600 R0
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL Digital\\srflop 2064 1536 R0
SYMATTR InstName A6
SYMBOL bv 1232 2048 R0
WINDOW 3 -80 166 Left 2
SYMATTR Value V= idt(V(ntrip_occ)/TTRIP, 0, V(ntrip_occ) < 0.5)
SYMATTR InstName B9
SYMBOL sw 1360 2032 R270
WINDOW 3 56 50 VRight 2
WINDOW 0 77 56 VRight 2
SYMATTR Value SWLATCH
SYMATTR InstName S12
SYMBOL res 1680 2048 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL Carregador_Bat 672 896 R0
SYMATTR InstName X1
SYMATTR SpiceLine Vdc_charger={V_CHARGER} Vrip_pp={VRIP} f_ripp = {F_RIP} R_out= {ROUT} L_out = {LOUT}
SYMBOL res 1456 528 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 0.4m
SYMBOL Carga_Bat 768 1152 R0
SYMATTR InstName X2
SYMATTR SpiceLine MODE = {Load_Type} R_LOAD = {R_Carga} R_ESR_C = {R_Cap_Serie} C_LOAD = {Cap} R_ESR_L = {R_Ind_Serie} L_LOAD = {Ind} V_INIT = {V_Cap_Init}
TEXT -1144 1384 Left 2 !.model SW_CHG_EN SW(Ron=50 Roff=1e9 Vt=0.5 Vh=0)
TEXT -392 1376 Left 2 !.model SW_DSG_EN SW(Ron=50 Roff=1e9 Vt=0.5 Vh=0)
TEXT -1144 1432 Left 2 !.model SW_CHG_INV_EN SW(Ron=1 Roff=1e9 Vt=0.5 Vh=0)
TEXT -392 1416 Left 2 !.model SW_DSG_INV_EN SW(Ron=1 Roff=1e9 Vt=0.5 Vh=0)
TEXT 376 1416 Left 2 !.model SW_LOAD SW(Ron=1m Roff=1e9 Vt=0.5 Vh=0)
TEXT -1536 1432 Left 2 !.tran 0 2 1m 50u
TEXT -1080 688 Left 4 ;Chaveamentos
TEXT 376 1368 Left 2 !.model SW_CHARGE SW(Ron=1u Roff=1e9 Vt=0.5 Vh=0)
TEXT -1072 -208 Left 4 ;Tensões DC
TEXT -1072 184 Left 4 ;Sinais de comando
TEXT -200 -216 Left 4 ;Sinais de acionamento dos pinos de gate
TEXT -1104 2248 Left 2 !.model SWOCD SW(Ron=1 Roff=1e9 Vt={VTH} Vh={VH})
TEXT -1544 1536 Left 2 !.param TTRIP = 500m
TEXT -120 2272 Left 2 !.model SWLATCH SW(Ron=1 Roff=1e9 Vt=1 Vh=0)
TEXT -1544 1560 Left 2 !.param ITRIP=24
TEXT 1136 2264 Left 2 !.model SWLATCH SW(Ron=1 Roff=1e9 Vt=1 Vh=0)
TEXT -1104 2224 Left 2 !.model SWOCC SW(Ron=1 Roff=1e9 Vt={VTH} Vh={Vh})
TEXT -1104 1496 Left 2 ;Lógica de detecção de limiar de corrente
TEXT -1544 1584 Left 2 !.param VTH= 1m*ITRIP\n.param VH=0
TEXT -176 1480 Left 2 ;Temporização da detecção do limiar de corrente em descarga
TEXT 1184 1456 Left 2 ;Temporização da detecção do limiar de corrente em descarga
TEXT -1600 1736 Left 2 ;Tensão sobre o resistor shunt
TEXT 840 912 Left 2 !.param V_CHARGER=50 VRIP=2
TEXT 840 1088 Left 2 !.param Load_Type = 2
TEXT 840 1120 Left 2 !.param R_Carga = 2 R_Cap_Serie = 50m Cap=500m
TEXT 840 944 Left 2 !.param F_RIP = 120 ROUT=50m
TEXT 840 968 Left 2 !.param LOUT=150u
TEXT 840 1144 Left 2 !.param R_Ind_Serie = 50m Ind = 500m
TEXT 840 1168 Left 2 !.param V_Cap_Init = 0
TEXT 840 1216 Left 2 !.step param Ind  list 100u 1m 10m 100m
RECTANGLE Normal 832 1328 -1088 704 2
RECTANGLE Normal -208 144 -1072 -176 2
RECTANGLE Normal 608 448 -192 -176 2
RECTANGLE Normal -416 656 -1072 224 2
RECTANGLE Normal -320 2192 -1104 1536 2
RECTANGLE Normal 1056 2256 -176 1504 2
RECTANGLE Normal 2336 2240 1104 1488 2
