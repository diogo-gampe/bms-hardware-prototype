Version 4
SHEET 1 3052 1784
WIRE 1824 -272 1632 -272
WIRE 2096 -272 1888 -272
WIRE 2272 -272 2160 -272
WIRE -560 -112 -640 -112
WIRE -368 -112 -432 -112
WIRE -64 -112 -128 -112
WIRE 1920 -112 1840 -112
WIRE 1840 -48 1840 -112
WIRE -432 -32 -432 -112
WIRE -128 -32 -128 -112
WIRE -640 -16 -640 -112
WIRE 1840 32 1680 32
WIRE 352 64 352 48
WIRE 352 64 320 64
WIRE 480 64 416 64
WIRE 720 64 672 64
WIRE 848 64 784 64
WIRE 1840 96 1840 32
WIRE -640 112 -640 64
WIRE -432 112 -432 48
WIRE -368 112 -432 112
WIRE -128 112 -128 48
WIRE -96 112 -128 112
WIRE 1680 112 1680 32
WIRE 1840 128 1840 96
WIRE 1840 128 1776 128
WIRE 320 160 320 64
WIRE 432 160 320 160
WIRE 672 176 672 64
WIRE 672 176 624 176
WIRE 736 176 672 176
WIRE 1840 176 1840 128
WIRE 320 208 320 160
WIRE 624 224 624 176
WIRE 1632 224 1632 -272
WIRE 1632 224 1440 224
WIRE 1680 224 1680 192
WIRE 1680 224 1632 224
WIRE 1776 224 1776 192
WIRE 1776 224 1680 224
WIRE 1824 224 1776 224
WIRE 2080 224 1920 224
WIRE 2208 224 2176 224
WIRE 2272 224 2272 -272
WIRE 2272 224 2208 224
WIRE 2304 224 2272 224
WIRE 2464 224 2304 224
WIRE 2592 224 2464 224
WIRE 2784 224 2592 224
WIRE 2928 224 2784 224
WIRE 2784 256 2784 224
WIRE 2464 272 2464 224
WIRE 2592 272 2592 224
WIRE -816 288 -896 288
WIRE -576 288 -656 288
WIRE 320 320 320 288
WIRE 1440 320 1440 224
WIRE 2208 320 2208 224
WIRE 2304 320 2304 224
WIRE 624 336 624 304
WIRE 2160 352 2160 272
WIRE 2784 352 2784 320
WIRE -896 384 -896 288
WIRE -656 384 -656 288
WIRE 2464 384 2464 352
WIRE 2512 384 2464 384
WIRE 2464 416 2464 384
WIRE 2592 416 2592 352
WIRE 2688 416 2592 416
WIRE 2160 432 2160 352
WIRE 2208 432 2208 384
WIRE 2208 432 2160 432
WIRE 2304 432 2304 400
WIRE 2304 432 2208 432
WIRE 2160 448 2160 432
WIRE 2512 448 2512 384
WIRE 2688 448 2688 416
WIRE 2592 464 2592 416
WIRE 2304 480 2304 432
WIRE 2784 480 2784 416
WIRE 2896 480 2784 480
WIRE 2960 480 2896 480
WIRE -896 512 -896 464
WIRE -656 512 -656 464
WIRE 2896 528 2896 480
WIRE 2512 544 2512 512
WIRE 2688 544 2688 512
WIRE 2304 608 2304 560
WIRE 1440 688 1440 400
WIRE 2160 688 2160 528
WIRE 2304 688 2304 672
WIRE 2304 688 2160 688
WIRE 2160 704 2160 688
WIRE 2304 720 2304 688
WIRE 656 864 560 864
WIRE 992 864 736 864
WIRE 992 880 992 864
WIRE -16 912 -112 912
WIRE 176 912 64 912
WIRE 672 912 608 912
WIRE -576 928 -704 928
WIRE -416 928 -496 928
WIRE 0 960 -64 960
WIRE 608 960 608 912
WIRE 720 960 720 912
WIRE 752 960 720 960
WIRE -560 976 -608 976
WIRE -64 1008 -64 960
WIRE 48 1008 48 960
WIRE 80 1008 48 1008
WIRE -608 1024 -608 976
WIRE -512 1024 -512 976
WIRE -496 1024 -512 1024
WIRE 992 1056 992 960
WIRE 992 1056 512 1056
WIRE 2176 1072 2096 1072
WIRE 2272 1072 2176 1072
WIRE 2416 1072 2272 1072
WIRE 2432 1072 2416 1072
WIRE 656 1152 560 1152
WIRE 976 1152 736 1152
WIRE 976 1168 976 1152
WIRE 2096 1168 2096 1072
WIRE -576 1184 -704 1184
WIRE -416 1184 -496 1184
WIRE -32 1184 -128 1184
WIRE 160 1184 48 1184
WIRE 2176 1184 2176 1136
WIRE 2176 1184 2144 1184
WIRE 2272 1184 2272 1152
WIRE 2272 1184 2176 1184
WIRE 672 1200 608 1200
WIRE -560 1232 -608 1232
WIRE -16 1232 -80 1232
WIRE 2176 1232 2176 1184
WIRE 608 1248 608 1200
WIRE 720 1248 720 1200
WIRE 752 1248 720 1248
WIRE -608 1280 -608 1232
WIRE -512 1280 -512 1232
WIRE -496 1280 -512 1280
WIRE -80 1280 -80 1232
WIRE 32 1280 32 1232
WIRE 64 1280 32 1280
WIRE 2096 1296 2096 1264
WIRE 2096 1296 1920 1296
WIRE 976 1344 976 1248
WIRE 976 1344 512 1344
WIRE 2176 1344 2176 1312
WIRE 2176 1456 2176 1408
WIRE 2176 1456 2160 1456
WIRE 2432 1456 2176 1456
FLAG -640 112 0
FLAG -560 -112 V_DRV
FLAG -896 512 0
FLAG -816 288 CMD_CHG
FLAG -656 512 0
FLAG -576 288 CMD_DCHG
FLAG -368 -112 CHG_DRV
FLAG -64 -112 DCHG_DRV
FLAG 1440 224 BAT+
FLAG 2928 224 PACK+
FLAG 1920 -112 CHG
FLAG 2160 704 DCHG
FLAG 2464 416 PACK
FLAG 2592 464 LD
FLAG 2960 480 PACK-
FLAG -368 112 BAT+
FLAG -96 112 BAT+
FLAG -608 1024 0
FLAG -496 1024 INV_EN_CHG
FLAG -64 1008 0
FLAG 80 1008 INV_EN_DCHG
FLAG -704 928 CHG
FLAG -416 928 BAT+
FLAG -608 1280 0
FLAG -496 1280 EN_CHG
FLAG -704 1184 CHG_DRV
FLAG -416 1184 CHG
FLAG -112 912 DCHG
FLAG 176 912 LD
FLAG -80 1280 0
FLAG 64 1280 EN_DCHG
FLAG -128 1184 DCHG_DRV
FLAG 160 1184 DCHG
FLAG 608 960 0
FLAG 752 960 EN_CHG
FLAG 560 864 PACK+
FLAG 512 1056 PACK-
FLAG 608 1248 0
FLAG 752 1248 EN_DCHG
FLAG 560 1152 PACK+
FLAG 512 1344 PACK-
FLAG 1440 688 0
FLAG 320 320 0
FLAG 432 160 EN_CHG
FLAG 624 336 0
FLAG 736 176 EN_DCHG
FLAG 848 64 INV_EN_DCHG
FLAG 480 64 INV_EN_CHG
FLAG 2160 352 D_GATE
FLAG 1840 96 C_GATE
FLAG 2416 1072 PACK+
FLAG 2432 1456 PACK-
FLAG 1920 1296 D_GATE
FLAG 2512 544 0
FLAG 2688 544 0
FLAG 2896 528 0
FLAG 2304 784 0
SYMBOL voltage 1440 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 48
SYMBOL voltage -640 -32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 11
SYMBOL voltage -896 368 R0
WINDOW 3 -104 209 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 1 150m 1 150.1m 0 300m 0)
SYMATTR InstName V3
SYMBOL voltage -656 368 R0
WINDOW 3 -138 253 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0 0 150m 0 150.1m 1 300m 1)
SYMATTR InstName V4
SYMBOL nmos 2080 272 R270
WINDOW 0 119 -8 VRight 2
WINDOW 3 141 -20 VRight 2
SYMATTR InstName M1
SYMATTR Value BSC160N10NS3
SYMBOL nmos 1920 176 R90
WINDOW 0 72 36 VRight 2
WINDOW 3 99 -56 VRight 2
SYMATTR InstName M2
SYMATTR Value BSC160N10NS3
SYMBOL cap 1888 -288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 0.1µ
SYMBOL cap 2160 -288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 0.1µ
SYMBOL res 1824 -64 R0
SYMATTR InstName R1
SYMATTR Value 5.1k
SYMBOL zener 1792 192 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value MMBZ16VALY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 1664 96 R0
WINDOW 0 1 150 Left 2
WINDOW 3 -24 177 Left 2
SYMATTR InstName R2
SYMATTR Value 10Meg
SYMBOL zener 2192 320 R0
SYMATTR InstName D2
SYMATTR Value MMBZ16VALY
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2320 416 R180
WINDOW 0 -40 98 Left 2
WINDOW 3 -74 65 Left 2
SYMATTR InstName R3
SYMATTR Value 10Meg
SYMBOL res 2144 432 R0
SYMATTR InstName R4
SYMATTR Value 5.1k
SYMBOL res 2448 256 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 2576 256 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL cap 2768 256 R0
SYMATTR InstName C3
SYMATTR Value 0.1µ
SYMBOL cap 2768 352 R0
SYMATTR InstName C4
SYMATTR Value 0.1µ
SYMBOL sw -592 928 R270
WINDOW 3 76 -21 VRight 2
SYMATTR Value SW_CHG_EN
SYMATTR InstName S1
SYMBOL sw -32 912 R270
WINDOW 3 81 -20 VRight 2
SYMATTR Value SW_DCHG_EN
SYMATTR InstName S2
SYMBOL sw -592 1184 R270
WINDOW 3 73 -25 VRight 2
SYMATTR Value SW_CHG_INV_EN
SYMATTR InstName S3
SYMBOL sw -48 1184 R270
WINDOW 3 78 -43 VRight 2
SYMATTR Value SW_DCHG_INV_EN
SYMATTR InstName S4
SYMBOL sw 640 864 R270
WINDOW 3 81 -20 VRight 2
SYMATTR Value SW_CHARGE
SYMATTR InstName S5
SYMBOL sw 640 1152 R270
WINDOW 3 81 -20 VRight 2
SYMATTR Value SW_LOAD
SYMATTR InstName S6
SYMBOL bv -432 -48 R0
SYMATTR InstName B2
SYMATTR Value V=V(V_DRV)
SYMBOL bv -128 -48 R0
SYMATTR InstName B4
SYMATTR Value V=V(V_DRV)
SYMBOL voltage 992 864 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 50
SYMBOL bv 320 192 R0
WINDOW 3 -46 186 Left 2
SYMATTR Value V={ if( V(CMD_CHG) > 0.5, 1, 0) }
SYMATTR InstName B6
SYMBOL bv 624 208 R0
WINDOW 3 -171 211 Left 2
SYMATTR Value V={if(V(CMD_DCHG) > 0.5, 1, 0) }
SYMATTR InstName B7
SYMBOL res 960 1152 R0
SYMATTR InstName R7
SYMATTR Value 20
SYMBOL Digital\\inv 720 0 R0
SYMATTR InstName A1
SYMBOL Digital\\inv 352 0 R0
SYMATTR InstName A2
SYMBOL zener 2160 1072 R0
WINDOW 3 -53 -46 Left 2
SYMATTR Value MMBZ16VALY
SYMATTR InstName D3
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2288 1168 R180
WINDOW 0 -40 98 Left 2
WINDOW 3 -74 65 Left 2
SYMATTR InstName R9
SYMATTR Value 10Meg
SYMBOL res 2160 1216 R0
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL diode 2192 1408 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL res 2288 464 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL diode 2288 608 R0
SYMATTR InstName D5
SYMBOL diode 2704 512 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMBOL diode 2528 512 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMBOL nmos 2144 1264 R180
WINDOW 0 103 29 Right 2
WINDOW 3 222 55 Right 2
SYMATTR InstName M3
SYMATTR Value BSC160N10NS3
SYMBOL diode 2320 784 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
TEXT -1000 1536 Left 2 !.model SW_CHG_EN SW(Ron=50 Roff=1e9 Vt=0.5 Vh=0)
TEXT -280 1520 Left 2 !.model SW_DCHG_EN SW(Ron=50 Roff=1e9 Vt=0.5 Vh=0)
TEXT -1000 1584 Left 2 !.model SW_CHG_INV_EN SW(Ron=1 Roff=1e9 Vt=0.5 Vh=0)
TEXT -280 1560 Left 2 !.model SW_DCHG_INV_EN SW(Ron=1 Roff=1e9 Vt=0.5 Vh=0)
TEXT 552 1560 Left 2 !.model SW_LOAD SW(Ron=1m Roff=1e9 Vt=0.5 Vh=0)
TEXT -1000 1608 Left 2 !.tran 0 500m 1m 1m
TEXT -824 752 Left 4 ;Chaveamentos
TEXT 552 1512 Left 2 !.model SW_CHARGE SW(Ron=1 Roff=1e9 Vt=0.5 Vh=0)
TEXT -720 -192 Left 4 ;Tensões DC
TEXT -1072 216 Left 4 ;Sinais de comando
TEXT 200 -104 Left 4 ;Sinais de acionamento de gate
RECTANGLE Normal 1088 1392 -832 768 2
RECTANGLE Normal 144 160 -720 -160 2
RECTANGLE Normal 144 672 -1072 240 2
RECTANGLE Normal 1008 560 208 -64 2
